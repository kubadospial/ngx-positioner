{"version":3,"file":"ngx-positioner.js.map","sources":["ng://ngx-positioner/src/lib/ngx-positioner.service.ts","ng://ngx-positioner/src/lib/ngx-positioner.directive.ts","ng://ngx-positioner/src/lib/ngx-positioner.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\nimport { Settings } from './models';\r\n\r\n@Injectable()\r\nexport class NgxPositionerService {\r\n\r\n    constructor() { }\r\n\r\n    changeSettings$ = new Subject<Settings>();\r\n    initialSettings: Settings = {\r\n        offset: {\r\n            isScrolledToBottom: 0,\r\n            isScrolledToTop: 0,\r\n            moveToBottom: 0,\r\n            moveToTop: 0,\r\n        },\r\n        delay: {\r\n            isScrolledToBottom: 0,\r\n            isScrolledToTop: 0,\r\n            moveToBottom: 0,\r\n            moveToTop: 0,\r\n        },\r\n        debounceTime: {\r\n            isScrolledToBottom: 0,\r\n            isScrolledToTop: 0,\r\n            moveToBottom: 0,\r\n            moveToTop: 0,\r\n        },\r\n        smoothScroll: {\r\n            moveToBottom: true,\r\n            moveToTop: true\r\n        }\r\n    };\r\n\r\n}\r\n\r\n","import { Directive, ElementRef, OnInit, Input, Output, EventEmitter, OnDestroy, Inject } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { fromEvent, Subject, of, Observable } from 'rxjs';\r\nimport { takeUntil, debounceTime, delay, switchMap, tap } from 'rxjs/operators';\r\n\r\nimport { Settings } from './models';\r\nimport { NgxPositionerService } from './ngx-positioner.service';\r\n\r\n\r\n@Directive({ selector: '[ngxPositioner]' })\r\nexport class NgxPositionerDirective implements OnInit, OnDestroy {\r\n    @Input('settings')\r\n    set settings(settings: Settings) {\r\n        this._mergeSetttings(settings);\r\n    }\r\n    @Input() moveToTop$ = new Subject<void>();\r\n    @Input() moveToBottom$ = new Subject<void>();\r\n    @Output() isScrolledToTop = new EventEmitter<boolean>();\r\n    @Output() isScrolledToBottom = new EventEmitter<boolean>();\r\n\r\n    private _scrollableElement: HTMLElement;\r\n    private _destroy$ = new Subject<void>();\r\n    private _stopAllSubscriptions$ = new Subject<void>();\r\n    private _scrollingEvent = new Subject<void>();\r\n    private _settings: Settings;\r\n\r\n    constructor(\r\n        private el: ElementRef,\r\n        @Inject(DOCUMENT) private document,\r\n        private positionerService: NgxPositionerService\r\n    ) { }\r\n\r\n    ngOnInit() {\r\n        this.isScrolledToTop.next(this._isScrolledToTopCondition);\r\n        this.isScrolledToBottom.next(this._isScrolledToBottomCondition);\r\n\r\n        this._initializeSubscriptions();\r\n\r\n        this.positionerService.changeSettings$.pipe(\r\n            takeUntil(this._destroy$)\r\n        ).subscribe((settings: Settings) => {\r\n            this._stopAllSubscriptions$.next();\r\n            this._mergeSetttings(settings);\r\n            this._initializeSubscriptions();\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this._destroy$.next();\r\n        this._destroy$.complete();\r\n        this._stopAllSubscriptions$.next();\r\n        this._stopAllSubscriptions$.complete();\r\n    }\r\n\r\n    private _initializeSubscriptions() {\r\n        fromEvent(this._scrollableElement, 'scroll').pipe(\r\n            takeUntil(this._stopAllSubscriptions$),\r\n        ).subscribe(_ => this._scrollingEvent.next());\r\n\r\n        // TOP\r\n        this._scrollingEvent.pipe(\r\n            debounceTime(this._settings.debounceTime.isScrolledToTop),\r\n            delay(this._settings.delay.isScrolledToTop),\r\n            switchMap(_ => of(this._isScrolledToTopCondition)),\r\n            takeUntil(this._stopAllSubscriptions$),\r\n        ).subscribe((isScrolledToTop: boolean) => this.isScrolledToTop.next(isScrolledToTop));\r\n\r\n        // BOTTOM\r\n        this._scrollingEvent.pipe(\r\n            debounceTime(this._settings.debounceTime.isScrolledToBottom),\r\n            delay(this._settings.delay.isScrolledToBottom),\r\n            switchMap(_ => of(this._isScrolledToBottomCondition)),\r\n            takeUntil(this._stopAllSubscriptions$),\r\n        ).subscribe((isScrolledToBottom: boolean) => this.isScrolledToBottom.next(isScrolledToBottom));\r\n\r\n        this.moveToTop$.pipe(\r\n            debounceTime(this._settings.debounceTime.moveToTop),\r\n            delay(this._settings.delay.moveToTop),\r\n            takeUntil(this._stopAllSubscriptions$)\r\n        ).subscribe(_ => this._onMoveToTop());\r\n\r\n        this.moveToBottom$.pipe(\r\n            debounceTime(this._settings.debounceTime.moveToBottom),\r\n            delay(this._settings.delay.moveToBottom),\r\n            takeUntil(this._stopAllSubscriptions$),\r\n            switchMap(_ => this._onMoveToBottom())\r\n        ).subscribe(height => this._scrollableElement.scroll({ behavior: this._moveToBottomBehavior, top: height + this._moveBottDiffOffset }))\r\n    }\r\n\r\n    private _mergeSetttings(settings: Settings) {\r\n        if (!!settings) {\r\n            this._settings = {\r\n                ...settings,\r\n                offset: {\r\n                    ...this.positionerService.initialSettings.offset,\r\n                    ...settings.offset\r\n                },\r\n                delay: {\r\n                    ...this.positionerService.initialSettings.delay,\r\n                    ...settings.delay\r\n                },\r\n                debounceTime: {\r\n                    ...this.positionerService.initialSettings.debounceTime,\r\n                    ...settings.debounceTime,\r\n                },\r\n                smoothScroll: {\r\n                    ...this.positionerService.initialSettings.smoothScroll,\r\n                    ...settings.smoothScroll,\r\n                }\r\n            };\r\n            this._setScrollableElement();\r\n        } else {\r\n            console.error(`%c Invalid settings object! `, 'color: #fff');\r\n        }\r\n    }\r\n\r\n    private _setScrollableElement() {\r\n        this._scrollableElement = this.el.nativeElement;\r\n        if (!!this._settings.scrollableElement) {\r\n            const scrollEl: HTMLElement = this.document.querySelector(this._settings.scrollableElement);\r\n            if (!!scrollEl) {\r\n                this._scrollableElement = scrollEl;\r\n            } else {\r\n                console.error(`%c Couldn't find ${ this._settings.scrollableElement } in DOM! `, 'color: #fff');\r\n            }\r\n        }\r\n    }\r\n\r\n    private _onMoveToTop() {\r\n        this._scrollableElement.scroll({ behavior: this._moveToTopBehavior, top: this._moveToTopOffset });\r\n    }\r\n\r\n    private _onMoveToBottom(): Observable<number> {\r\n        return of(this._moveToBottomOffset).pipe(\r\n            tap(height => this._scrollableElement.scroll({ behavior: this._moveToBottomBehavior, top: height })),\r\n            delay(this._settings.smoothScroll.moveToBottom ? 600 : 0)\r\n        )\r\n    }\r\n\r\n    private get _moveToTopBehavior(): ScrollBehavior {\r\n        return this._settings.smoothScroll.moveToTop ? 'smooth' : 'auto';\r\n    }\r\n\r\n    private get _moveToBottomBehavior(): ScrollBehavior {\r\n        return this._settings.smoothScroll.moveToBottom ? 'smooth' : 'auto';\r\n    }\r\n\r\n    private get _isScrolledToTopCondition(): boolean {\r\n        return this._scrollableElement.scrollTop <= this._isScrolledToTopOffset;\r\n    }\r\n\r\n    private get _isScrolledToBottomCondition(): boolean {\r\n        return this._scrollableElement.scrollTop + this._scrollableElement.clientHeight >= this._isScrolledToBottomOffset;\r\n    }\r\n\r\n    private get _isScrolledToTopOffset() {\r\n        return this._settings.offset.isScrolledToTop;\r\n    }\r\n\r\n    private get _isScrolledToBottomOffset(): number {\r\n        return this._scrollableElement.scrollHeight - this._settings.offset.isScrolledToBottom;\r\n    }\r\n\r\n    private get _moveToTopOffset(): number {\r\n        return this._settings.offset.moveToTop;\r\n    }\r\n\r\n    private get _moveToBottomOffset(): number {\r\n        if (!this._settings.offset.moveToBottom) {\r\n            return this._scrollableElement.scrollHeight;\r\n        } else {\r\n            return this._scrollableElement.offsetHeight - this._settings.offset.moveToBottom;\r\n        }\r\n    }\r\n\r\n    private get _moveBottDiffOffset() {\r\n        let diff = this._scrollableElement.scrollTop - this._scrollableElement.offsetHeight;\r\n        if (!!this._settings.offset.moveToBottom) {\r\n            diff = (this._scrollableElement.scrollHeight - (this._scrollableElement.scrollTop + this._scrollableElement.offsetHeight)) - this._settings.offset.moveToBottom;\r\n        }\r\n        return diff;\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgxPositionerDirective } from './ngx-positioner.directive';\r\nimport { NgxPositionerService } from './ngx-positioner.service';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  exports: [NgxPositionerDirective],\r\n  declarations: [NgxPositionerDirective],\r\n  providers: [NgxPositionerService]\r\n})\r\nexport class NgxPositionerModule { }\r\n"],"names":[],"mappings":"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"}
